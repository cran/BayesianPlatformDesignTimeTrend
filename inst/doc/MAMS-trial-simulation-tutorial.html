<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ziyan Wang" />


<title>MAMS-trial-simulation-tutorial</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MAMS-trial-simulation-tutorial</h1>
<h4 class="author">Ziyan Wang</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(BayesianPlatformDesignTimeTrend)</span></code></pre></div>
<div id="four-arm-trial-simulation" class="section level2">
<h2>Four arm trial simulation</h2>
<p>The ‘BayesianPlatformDesignTimeTrend’ package simulation process
requires stopping boundary cutoff screening first (details refers to
demo and MAMS-CutoffScreening-tutorial). After the cutoff screening
process, we need to record the cutoff value of both efficacy and
futility boundary for use in the trial simulation process. The data of
each trail replicates will be created sequentailly during the
simulation. In this tutorial, the example is a four-arm MAMS trial with
one control and three treatment arms. The control arm will not be
stopped during the trial. The time trend pattern are set to be ‘linear’.
The way of time trend impacting the beginning response probability is
set to be ‘mult’ (multiplicative). The time trend strength is set to be
zero first and then set to be 0.5 to study the impact of time trend on
different evaluation metrics. The model used in this example are fixed
effect model (the model with only treatment effect and the model with
both treatment effect and discrete stage effect). The evaluation metrics
are error rate, mean treatment effect bias, rooted MSE, mean number of
patients allocated to each arm and mean total number of patients in the
trial.</p>
<p>Firstly, We investigate the family wise error rate (FWER) for
different time trend strength and how model with stage effect help
control the family wise error rate. The cutoff value was screened for
null scenario using model only main effect in order to control the FWER
under 0.1. The false positive rate is 0.037 equally for each treatment -
control comparison.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>ntrials <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># Number of trial replicates</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>ns <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">120</span>,<span class="dv">600</span>,<span class="dv">120</span>) <span class="co"># Sequence of total number of accrued patients at each interim analysis</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>null.reponse.prob <span class="ot">=</span> <span class="fl">0.4</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>alt.response.prob <span class="ot">=</span> <span class="fl">0.6</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># We investigate the type I error rate for different time trend strength</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>null.scenario <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>    null.reponse.prob</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  ),</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  <span class="at">byrow =</span> T</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co"># alt.scenario = matrix(c(null.reponse.prob,null.reponse.prob,null.reponse.prob,null.reponse.prob,</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#                     null.reponse.prob,alt.response.prob,null.reponse.prob,null.reponse.prob,</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#                     null.reponse.prob,alt.response.prob,alt.response.prob,null.reponse.prob,</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#                     null.reponse.prob,alt.response.prob,alt.response.prob,alt.response.prob), nrow=3, ncol = 4,byrow=T)</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>model <span class="ot">=</span> <span class="st">&quot;tlr&quot;</span> <span class="co">#logistic model</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>max.ar <span class="ot">=</span> <span class="fl">0.75</span>  <span class="co">#limit the allocation ratio for the control group (1-max.ar &lt; r_control &lt; max.ar)</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#------------Select the data generation randomisation methods-------</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>rand.type <span class="ot">=</span> <span class="st">&quot;Urn&quot;</span> <span class="co"># Urn design</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>max.deviation <span class="ot">=</span> <span class="dv">3</span> <span class="co"># The recommended value for the tuning parameter in the Urn design</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co"># Require multiple cores for parallel running</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>cl <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co"># Set the model we want to use and the time trend effect for each model used.</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co"># Here the main model will be used twice for two different strength of time trend c(0,0,0,0) and c(1,1,1,1) to investigate how time trend affect the evaluation metrics in BAR setting.</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co"># Then the main + stage_continuous model which is the treatment effect + stage effect model will be applied for strength equal c(1,1,1,1) to investigate how the main + stage effect model improve the evaluation metrics.</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>reg.inf <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;main&quot;</span>, <span class="st">&quot;main&quot;</span>, <span class="st">&quot;main + stage_continuous&quot;</span>)</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>trend.effect <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>),</span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>  <span class="at">byrow =</span> T</span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>)</span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>cutoffearly <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fl">0.994</span>, <span class="fu">dim</span>(null.scenario)[<span class="dv">1</span>]), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">dim</span>(null.scenario)[<span class="dv">2</span>]</span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a>  <span class="fu">paste0</span>(</span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>    <span class="st">&quot;Start trial simulation. This is a &quot;</span>,</span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a>    K,</span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>    <span class="st">&quot;-arm trial simulation. There are one null scenario and &quot;</span>,</span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>    K <span class="sc">-</span> <span class="dv">1</span> ,</span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>    <span class="st">&quot; alternative scenarios. There are &quot;</span>,</span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>    K ,</span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>    <span class="st">&quot; rounds.&quot;</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a>  )</span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a>)</span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Start trial simulation. This is a 4-arm trial simulation. There are one null scenario and 3 alternative scenarios. There are 4 rounds.&quot;</span></span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a>cutoffindex <span class="ot">=</span> <span class="dv">1</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>result <span class="ot">=</span> {</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>OPC_null <span class="ot">=</span> {</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>}</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(null.scenario)[<span class="dv">1</span>]) {</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  trendindex <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(reg.inf)){</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    restlr <span class="ot">=</span> <span class="fu">Trial.simulation</span>(</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>      <span class="at">ntrials =</span> ntrials,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>      <span class="co"># Number of trial replicates</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>      <span class="at">trial.fun =</span> simulatetrial,</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>      <span class="co"># Call the main function</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>      <span class="at">input.info =</span> <span class="fu">list</span>(</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>        <span class="at">response.probs =</span> null.scenario[cutoffindex, ],</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>        <span class="co">#The scenario vector in this round</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>        <span class="at">ns =</span> ns,</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>        <span class="co"># Sequence of total number of accrued patients at each interim analysis</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>        <span class="at">max.ar =</span>  max.ar,</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>        <span class="co">#limit the allocation ratio for the control group (1-max.ar &lt; r_control &lt; max.ar)</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>        <span class="at">rand.type =</span> rand.type,</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>        <span class="co"># Which randomisation methods in data generation.</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>        <span class="at">max.deviation =</span> max.deviation,</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>        <span class="co"># The recommended value for the tuning parameter in the Urn design</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>        <span class="at">model.inf =</span> <span class="fu">list</span>(</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>          <span class="at">model =</span> model,</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>          <span class="co">#Use which model?</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>          <span class="at">ibb.inf =</span> <span class="fu">list</span>(</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>            <span class="co">#independent beta-binomial model which can be used only for no time trend simulation</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>            <span class="at">pi.star =</span> <span class="fl">0.5</span>,</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>            <span class="co"># beta prior mean</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>            <span class="at">pess =</span> <span class="dv">2</span>,</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>            <span class="co"># beta prior effective sample size</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>            <span class="at">betabinomialmodel =</span> ibetabinomial.post <span class="co"># beta-binomial model for posterior estimation</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>          ),</span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>          <span class="at">tlr.inf =</span> <span class="fu">list</span>(</span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>            <span class="at">beta0_prior_mu =</span> <span class="dv">0</span>,</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior location</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>            <span class="at">beta1_prior_mu =</span> <span class="dv">0</span>,</span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior location</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>            <span class="at">beta0_prior_sigma =</span> <span class="fl">2.5</span>,</span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior sigma</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>            <span class="at">beta1_prior_sigma =</span> <span class="fl">2.5</span>,</span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior sigma</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>            <span class="at">beta0_df =</span> <span class="dv">7</span>,</span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior degree of freedom</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>            <span class="at">beta1_df =</span> <span class="dv">7</span>,</span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior degree of freedom</span></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>            <span class="at">reg.inf =</span>  reg.inf[trendindex],</span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>            <span class="co"># The model we want to use</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>            <span class="at">variable.inf =</span> <span class="st">&quot;Fixeffect&quot;</span> <span class="co"># Use fix effect logistic model</span></span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>          )</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>        ),</span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a>        <span class="at">Stopbound.inf =</span> <span class="fu">Stopboundinf</span>(</span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a>          <span class="at">Stop.type =</span> <span class="st">&quot;Early-Pocock&quot;</span>,</span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>          <span class="co"># Use Pocock like early stopping boundary</span></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>          <span class="at">Boundary.type =</span> <span class="st">&quot;Symmetric&quot;</span>,</span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>          <span class="co"># Use Symmetric boundary where cutoff value for efficacy boundary and futility boundary sum up to 1</span></span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>          <span class="at">cutoff =</span> <span class="fu">c</span>(cutoffearly[cutoffindex, <span class="dv">1</span>], <span class="dv">1</span> <span class="sc">-</span> cutoffearly[cutoffindex, <span class="dv">1</span>]) <span class="co"># The cutoff value for stopping boundary</span></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>        ),</span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>        <span class="at">Random.inf =</span> <span class="fu">list</span>(</span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>          <span class="at">Fixratio =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>          <span class="co"># Do not use fix ratio allocation</span></span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>          <span class="at">Fixratiocontrol =</span> <span class="cn">NA</span>,</span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a>          <span class="co"># Do not use fix ratio allocation</span></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a>          <span class="at">BARmethod =</span> <span class="st">&quot;Thall&quot;</span>,</span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>          <span class="co"># Use Thall&#39;s Bayesian adaptive randomisation approach</span></span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a>          <span class="at">Thall.tuning.inf =</span> <span class="fu">list</span>(<span class="at">tuningparameter =</span> <span class="st">&quot;Fixed&quot;</span>,  <span class="at">fixvalue =</span> <span class="dv">1</span>) <span class="co"># Specified the tunning parameter value for fixed tuning parameter</span></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a>        ),</span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a>        <span class="at">trend.inf =</span> <span class="fu">list</span>(</span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a>          <span class="at">trend.type =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a>          <span class="co"># Linear time trend pattern</span></span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a>          <span class="at">trend.effect =</span> trend.effect[trendindex, ],</span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>          <span class="co"># Stength of time trend effect</span></span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a>          <span class="at">trend_add_or_multip =</span> <span class="st">&quot;mult&quot;</span> <span class="co"># Multiplicative time trend effect on response probability</span></span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a>        )</span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a>      ),</span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a>      <span class="at">cl =</span> <span class="dv">2</span> <span class="co"># 2 cores required</span></span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a>    )</span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a>  trendindex <span class="ot">=</span> trendindex <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a>  <span class="co"># The result list can be used for plotting and the OPC table is the summary evaluaton metrics for each scenario</span></span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a>  result <span class="ot">=</span> <span class="fu">c</span>(result, restlr<span class="sc">$</span>result)</span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a>  OPC_null <span class="ot">=</span> <span class="fu">rbind</span>(OPC_null, restlr<span class="sc">$</span>OPC)</span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a>  }</span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a>  cutoffindex <span class="ot">=</span> cutoffindex <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Finished null scenario study&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Finished null scenario study&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>save_data <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">isTRUE</span>(save_data)) {</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">save</span>(result, <span class="at">file =</span> restlr<span class="sc">$</span>Nameofsaveddata<span class="sc">$</span>nameData)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">save</span>(OPC_null, <span class="at">file =</span> restlr<span class="sc">$</span>Nameofsaveddata<span class="sc">$</span>nameTable)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Present the evaluation metrics for null scenario. The FWER is 0.1
when there is no time trend. FWER inflated to 0.1296 when there is a
step time trend pattern and modeled by main fixed effect model. The main
effect plus stage effect model controls the FWER again under 0.1.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Characteristic table</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">print</span>(OPC_null)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;                                                           Type.I.Error.or.Power</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                                       0.0920</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                                   0.1269</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5                0.0942</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;                                                               Bias.1     Bias.2</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                        -0.0017950  0.0017528</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                     0.0027425  0.0001126</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5 -0.0075998 -0.0047135</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;                                                               Bias.3    rMSE.1</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                        -0.0047363 0.3071620</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                     0.0005532 0.3465008</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5 -0.0064670 0.3158225</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;                                                              rMSE.2    rMSE.3</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                        0.3216471 0.3210915</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                    0.3470985 0.3441727</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5 0.3253357 0.3160819</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt;                                                           N.per.arm.1</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                           149.5994</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                       149.8267</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5    150.9300</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt;                                                           N.per.arm.2</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                           150.4572</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                       149.7345</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5    149.1794</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt;                                                           N.per.arm.3</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                           149.7173</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                       149.7167</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5    149.6287</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="co">#&gt;                                                           N.per.arm.4</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                           149.7461</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                       149.8821</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5    149.7699</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co">#&gt;                                                           Survive.per.arm.1</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                                  59.8228</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                              67.3003</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5           67.9718</span></span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="co">#&gt;                                                           Survive.per.arm.2</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                                  60.1033</span></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                              67.2081</span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5           66.9753</span></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a><span class="co">#&gt;                                                           Survive.per.arm.3</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                                  59.9199</span></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                              67.2191</span></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5           67.2767</span></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a><span class="co">#&gt;                                                           Survive.per.arm.4</span></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                                  59.8687</span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                              67.2769</span></span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5           67.1882</span></span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a><span class="co">#&gt;                                                                 N</span></span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend0000 main stage5                        599.520</span></span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main stage5                    599.160</span></span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a><span class="co">#&gt; 04040404 Timetrend01010101 main + stage_continuous stage5 599.508</span></span></code></pre></div>
<p>Then, We investigate the other evaluation metrics for alternative
scenario with different time trend strength. The cutoff value was the
same as the value in precious example since the control arm response
probability in alternative scenario are the same as that in null
scenario.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>ntrials <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># Number of trial replicates</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>ns <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">120</span>,<span class="dv">600</span>,<span class="dv">120</span>) <span class="co"># Sequence of total number of accrued patients at each interim analysis</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>null.reponse.prob <span class="ot">=</span> <span class="fl">0.4</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>alt.response.prob <span class="ot">=</span> <span class="fl">0.6</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># We investigate the type I error rate for different time trend strength</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>alt.scenario <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    alt.response.prob,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>    alt.response.prob,</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>    alt.response.prob,</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>    null.reponse.prob,</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>    alt.response.prob,</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>    alt.response.prob,</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>    alt.response.prob</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  ),</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  <span class="at">byrow =</span> T</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>)</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>model <span class="ot">=</span> <span class="st">&quot;tlr&quot;</span> <span class="co">#logistic model</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>max.ar <span class="ot">=</span> <span class="fl">0.75</span>  <span class="co">#limit the allocation ratio for the control group (1-max.ar &lt; r_control &lt; max.ar)</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#------------Select the data generation randomisation methods-------</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>rand.type <span class="ot">=</span> <span class="st">&quot;Urn&quot;</span> <span class="co"># Urn design</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>max.deviation <span class="ot">=</span> <span class="dv">3</span> <span class="co"># The recommended value for the tuning parameter in the Urn design</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co"># Require multiple cores for parallel running</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>cl <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co"># Set the model we want to use and the time trend effect for each model used.</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co"># Here the main model will be used twice for two different strength of time trend c(0,0,0,0) and c(1,1,1,1) to investigate how time trend affect the evaluation metrics in BAR setting.</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co"># Then the main + stage_continuous model which is the treatment effect + stage effect model will be applied for strength equal c(1,1,1,1) to investigate how the main + stage effect model improve the evaluation metrics.</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>reg.inf <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;main + stage_continuous&quot;</span>)</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>trend.effect <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>),</span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a>                      <span class="at">byrow =</span> T)</span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>cutoffearly <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fl">0.994</span>, <span class="fu">dim</span>(alt.scenario)[<span class="dv">1</span>]), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">dim</span>(alt.scenario)[<span class="dv">2</span>]</span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a>  <span class="fu">paste0</span>(</span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a>    <span class="st">&quot;Start trial simulation. This is a &quot;</span>,</span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a>    K,</span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a>    <span class="st">&quot;-arm trial simulation. There are one null scenario and &quot;</span>,</span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a>    K <span class="sc">-</span> <span class="dv">1</span> ,</span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a>    <span class="st">&quot; alternative scenarios. There are &quot;</span>,</span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a>    K ,</span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a>    <span class="st">&quot; rounds.&quot;</span></span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a>  )</span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a>)</span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Start trial simulation. This is a 4-arm trial simulation. There are one null scenario and 3 alternative scenarios. There are 4 rounds.&quot;</span></span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a>cutoffindex <span class="ot">=</span> <span class="dv">1</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>result <span class="ot">=</span> {</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>}</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>OPCalt <span class="ot">=</span> {</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  </span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>}</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(alt.scenario)[<span class="dv">1</span>]) {</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  trendindex <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(reg.inf)){</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>    restlr <span class="ot">=</span> <span class="fu">Trial.simulation</span>(</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>      <span class="at">ntrials =</span> ntrials,</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>      <span class="co"># Number of trial replicates</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>      <span class="at">trial.fun =</span> simulatetrial,</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>      <span class="co"># Call the main function</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>      <span class="at">input.info =</span> <span class="fu">list</span>(</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>        <span class="at">response.probs =</span> alt.scenario[cutoffindex, ],</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>        <span class="co">#The scenario vector in this round</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>        <span class="at">ns =</span> ns,</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>        <span class="co"># Sequence of total number of accrued patients at each interim analysis</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>        <span class="at">max.ar =</span>  max.ar,</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>        <span class="co">#limit the allocation ratio for the control group (1-max.ar &lt; r_control &lt; max.ar)</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>        <span class="at">rand.type =</span> rand.type,</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>        <span class="co"># Which randomisation methods in data generation.</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>        <span class="at">max.deviation =</span> max.deviation,</span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>        <span class="co"># The recommended value for the tuning parameter in the Urn design</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>        <span class="at">model.inf =</span> <span class="fu">list</span>(</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>          <span class="at">model =</span> model,</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>          <span class="co">#Use which model?</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>          <span class="at">ibb.inf =</span> <span class="fu">list</span>(</span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>            <span class="co">#independent beta-binomial model which can be used only for no time trend simulation</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a>            <span class="at">pi.star =</span> <span class="fl">0.5</span>,</span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a>            <span class="co"># beta prior mean</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a>            <span class="at">pess =</span> <span class="dv">2</span>,</span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a>            <span class="co"># beta prior effective sample size</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a>            <span class="at">betabinomialmodel =</span> ibetabinomial.post <span class="co"># beta-binomial model for posterior estimation</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a>          ),</span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a>          <span class="at">tlr.inf =</span> <span class="fu">list</span>(</span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a>            <span class="at">beta0_prior_mu =</span> <span class="dv">0</span>,</span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior location</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a>            <span class="at">beta1_prior_mu =</span> <span class="dv">0</span>,</span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior location</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a>            <span class="at">beta0_prior_sigma =</span> <span class="fl">2.5</span>,</span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior sigma</span></span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a>            <span class="at">beta1_prior_sigma =</span> <span class="fl">2.5</span>,</span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior sigma</span></span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a>            <span class="at">beta0_df =</span> <span class="dv">7</span>,</span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior degree of freedom</span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a>            <span class="at">beta1_df =</span> <span class="dv">7</span>,</span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a>            <span class="co"># Stan logistic model t prior degree of freedom</span></span>
<span id="cb7-51"><a href="#cb7-51" tabindex="-1"></a>            <span class="at">reg.inf =</span>  reg.inf[trendindex],</span>
<span id="cb7-52"><a href="#cb7-52" tabindex="-1"></a>            <span class="co"># The model we want to use</span></span>
<span id="cb7-53"><a href="#cb7-53" tabindex="-1"></a>            <span class="at">variable.inf =</span> <span class="st">&quot;Fixeffect&quot;</span> <span class="co"># Use fix effect logistic model</span></span>
<span id="cb7-54"><a href="#cb7-54" tabindex="-1"></a>          )</span>
<span id="cb7-55"><a href="#cb7-55" tabindex="-1"></a>        ),</span>
<span id="cb7-56"><a href="#cb7-56" tabindex="-1"></a>        <span class="at">Stopbound.inf =</span> <span class="fu">Stopboundinf</span>(</span>
<span id="cb7-57"><a href="#cb7-57" tabindex="-1"></a>          <span class="at">Stop.type =</span> <span class="st">&quot;Early-Pocock&quot;</span>,</span>
<span id="cb7-58"><a href="#cb7-58" tabindex="-1"></a>          <span class="co"># Use Pocock like early stopping boundary</span></span>
<span id="cb7-59"><a href="#cb7-59" tabindex="-1"></a>          <span class="at">Boundary.type =</span> <span class="st">&quot;Symmetric&quot;</span>,</span>
<span id="cb7-60"><a href="#cb7-60" tabindex="-1"></a>          <span class="co"># Use Symmetric boundary where cutoff value for efficacy boundary and futility boundary sum up to 1</span></span>
<span id="cb7-61"><a href="#cb7-61" tabindex="-1"></a>          <span class="at">cutoff =</span> <span class="fu">c</span>(cutoffearly[cutoffindex, <span class="dv">1</span>], <span class="dv">1</span> <span class="sc">-</span> cutoffearly[cutoffindex, <span class="dv">1</span>]) <span class="co"># The cutoff value for stopping boundary</span></span>
<span id="cb7-62"><a href="#cb7-62" tabindex="-1"></a>        ),</span>
<span id="cb7-63"><a href="#cb7-63" tabindex="-1"></a>        <span class="at">Random.inf =</span> <span class="fu">list</span>(</span>
<span id="cb7-64"><a href="#cb7-64" tabindex="-1"></a>          <span class="at">Fixratio =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-65"><a href="#cb7-65" tabindex="-1"></a>          <span class="co"># Do not use fix ratio allocation</span></span>
<span id="cb7-66"><a href="#cb7-66" tabindex="-1"></a>          <span class="at">Fixratiocontrol =</span> <span class="cn">NA</span>,</span>
<span id="cb7-67"><a href="#cb7-67" tabindex="-1"></a>          <span class="co"># Do not use fix ratio allocation</span></span>
<span id="cb7-68"><a href="#cb7-68" tabindex="-1"></a>          <span class="at">BARmethod =</span> <span class="st">&quot;Thall&quot;</span>,</span>
<span id="cb7-69"><a href="#cb7-69" tabindex="-1"></a>          <span class="co"># Use Thall&#39;s Bayesian adaptive randomisation approach</span></span>
<span id="cb7-70"><a href="#cb7-70" tabindex="-1"></a>          <span class="at">Thall.tuning.inf =</span> <span class="fu">list</span>(<span class="at">tuningparameter =</span> <span class="st">&quot;Fixed&quot;</span>,  <span class="at">fixvalue =</span> <span class="dv">1</span>) <span class="co"># Specified the tunning parameter value for fixed tuning parameter</span></span>
<span id="cb7-71"><a href="#cb7-71" tabindex="-1"></a>        ),</span>
<span id="cb7-72"><a href="#cb7-72" tabindex="-1"></a>        <span class="at">trend.inf =</span> <span class="fu">list</span>(</span>
<span id="cb7-73"><a href="#cb7-73" tabindex="-1"></a>          <span class="at">trend.type =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb7-74"><a href="#cb7-74" tabindex="-1"></a>          <span class="co"># Linear time trend pattern</span></span>
<span id="cb7-75"><a href="#cb7-75" tabindex="-1"></a>          <span class="at">trend.effect =</span> trend.effect[trendindex, ],</span>
<span id="cb7-76"><a href="#cb7-76" tabindex="-1"></a>          <span class="co"># Stength of time trend effect</span></span>
<span id="cb7-77"><a href="#cb7-77" tabindex="-1"></a>          <span class="at">trend_add_or_multip =</span> <span class="st">&quot;mult&quot;</span> <span class="co"># Multiplicative time trend effect on response probability</span></span>
<span id="cb7-78"><a href="#cb7-78" tabindex="-1"></a>        )</span>
<span id="cb7-79"><a href="#cb7-79" tabindex="-1"></a>      ),</span>
<span id="cb7-80"><a href="#cb7-80" tabindex="-1"></a>      <span class="at">cl =</span> <span class="dv">2</span> <span class="co"># 2 cores required</span></span>
<span id="cb7-81"><a href="#cb7-81" tabindex="-1"></a>    )</span>
<span id="cb7-82"><a href="#cb7-82" tabindex="-1"></a>  trendindex <span class="ot">=</span> trendindex <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-83"><a href="#cb7-83" tabindex="-1"></a>  <span class="co"># The result list can be used for plotting and the OPC table is the summary evaluaton metrics for each scenario</span></span>
<span id="cb7-84"><a href="#cb7-84" tabindex="-1"></a>  result <span class="ot">=</span> <span class="fu">c</span>(result, restlr<span class="sc">$</span>result)</span>
<span id="cb7-85"><a href="#cb7-85" tabindex="-1"></a>  OPC_alt <span class="ot">=</span> <span class="fu">rbind</span>(OPC_alt, restlr<span class="sc">$</span>OPC)</span>
<span id="cb7-86"><a href="#cb7-86" tabindex="-1"></a>  }  </span>
<span id="cb7-87"><a href="#cb7-87" tabindex="-1"></a>  cutoffindex <span class="ot">=</span> cutoffindex <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-88"><a href="#cb7-88" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Finished alternative scenario study&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Finished alternative scenario study&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>save_data <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">isTRUE</span>(save_data)) {</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">save</span>(result, <span class="at">file =</span> restlr<span class="sc">$</span>Nameofsaveddata<span class="sc">$</span>nameData)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">save</span>(OPC_alt, <span class="at">file =</span> restlr<span class="sc">$</span>Nameofsaveddata<span class="sc">$</span>nameTable)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Present the evaluation metrics for alternative scenarios. The power
used here is the conjunctive power where the trial will be sucessful
only if the effective arms are correctly claimed to be effective and all
other null arms are claimed to be ineffective.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Characteristic table</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">print</span>(OPC_alt)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;                                                           Type.I.Error.or.Power</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5                0.5148</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5                0.6612</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5                0.5621</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt;                                                              Bias.1     Bias.2</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5 0.1008942 -0.0200847</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5 0.1382469  0.1426271</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5 0.1195935  0.1226108</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;                                                               Bias.3    rMSE.1</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5 -0.0241128 0.4537455</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5 -0.0192185 0.4234063</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5  0.1188816 0.4224861</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt;                                                              rMSE.2    rMSE.3</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5 0.3757555 0.3831709</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5 0.4293264 0.3449225</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5 0.4294485 0.4305815</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt;                                                           N.per.arm.1</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5    116.5303</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5    124.5913</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5     79.0515</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt;                                                           N.per.arm.2</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5    200.7436</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5    153.2433</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5    140.7811</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt;                                                           N.per.arm.3</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5    141.4709</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5    152.4769</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5    140.7366</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt;                                                           N.per.arm.4</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5    140.8112</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5    164.8645</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5    141.5108</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt;                                                           Survive.per.arm.1</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5           85.8683</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5           56.3024</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5           34.3717</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt;                                                           Survive.per.arm.2</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5          172.9814</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5           98.2435</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5           90.4030</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt;                                                           Survive.per.arm.3</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5          107.4409</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5           97.8080</span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5           90.3950</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="co">#&gt;                                                           Survive.per.arm.4</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5          106.9263</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5           75.2079</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5           90.7811</span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt;                                                                 N</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt; 04060404 Timetrend01010101 main + stage_continuous stage5 599.556</span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; 04060604 Timetrend01010101 main + stage_continuous stage5 595.176</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; 04060606 Timetrend01010101 main + stage_continuous stage5 502.080</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
